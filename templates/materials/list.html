<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜ì—… ìë£Œ - Python í•™ìŠµ í”Œë«í¼</title>
    <link rel="stylesheet" href="/static/css/common.css">
    <link rel="stylesheet" href="/static/css/materials.css">
</head>
<body>
    <nav>
        <div class="container">
            <a href="/" class="logo">ğŸ Python í•™ìŠµ</a>
            <ul>
                <li><a href="/">í™ˆ</a></li>
                <li><a href="/materials">ìˆ˜ì—… ìë£Œ</a></li>
                <li><a href="/practice">ë¬¸ì œ í’€ì´</a></li>
                <li><a href="/profile/history">ë‚´ ê¸°ë¡</a></li>
                <li id="auth-nav"></li>
            </ul>
        </div>
    </nav>

    <div class="materials-header">
        <div class="container">
            <h1>ğŸ“š ìˆ˜ì—… ìë£Œ</h1>
            <div class="materials-filters">
                <div class="filter-group">
                    <label for="category-filter">ì¹´í…Œê³ ë¦¬:</label>
                    <select id="category-filter">
                        <option value="">ì „ì²´</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="difficulty-filter">ë‚œì´ë„:</label>
                    <select id="difficulty-filter">
                        <option value="">ì „ì²´</option>
                        <option value="beginner">ì´ˆê¸‰</option>
                        <option value="intermediate">ì¤‘ê¸‰</option>
                        <option value="advanced">ê³ ê¸‰</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="error-message" class="alert alert-error"></div>
        <div id="loader" class="loader"></div>
        <div id="materials-list" class="materials-list"></div>
    </div>

    <script src="/static/js/utils.js"></script>
    <script src="/static/js/api.js"></script>
    <script src="/static/js/materials.js"></script>
    <script>
        // ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ ì„¤ì •
        const authNav = document.getElementById('auth-nav');
        if (isLoggedIn()) {
            const user = getCurrentUser();
            authNav.innerHTML = `
                <span style="color: white; margin-right: 1rem;">ğŸ‘¤ ${escapeHtml(user.username)}</span>
                <a href="#" onclick="AuthAPI.logout(); return false;">ë¡œê·¸ì•„ì›ƒ</a>
            `;
        } else {
            authNav.innerHTML = '<a href="/login">ë¡œê·¸ì¸</a>';
        }

        // ì¹´í…Œê³ ë¦¬ ëª©ë¡ ë¡œë“œ
        async function loadCategories() {
            try {
                const response = await MaterialsAPI.getCategories();
                if (response.success) {
                    const select = document.getElementById('category-filter');
                    response.data.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = cat;
                        select.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('ì¹´í…Œê³ ë¦¬ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // í•„í„° ë³€ê²½ ì‹œ ìë£Œ ë‹¤ì‹œ ë¡œë“œ
        document.getElementById('category-filter').addEventListener('change', (e) => {
            const difficulty = document.getElementById('difficulty-filter').value;
            loadMaterials(e.target.value || null, difficulty || null);
        });

        document.getElementById('difficulty-filter').addEventListener('change', (e) => {
            const category = document.getElementById('category-filter').value;
            loadMaterials(category || null, e.target.value || null);
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        loadCategories();
        loadMaterials();
    </script>
</body>
</html>

